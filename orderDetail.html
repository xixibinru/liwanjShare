<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>确认订单</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/orderDetail.css">
</head>
<body>
<header  id="header"><a href="">返回</a>订单详情</header>

<section v-if="order" id="order">
    <div class="orderState">
        <p>{{order.status}}</p>
        <!--<p>等待商家发货中</p>-->
        <img :class="{daifahuo:order.status=='待发货',yifahuo:order.status=='待收货'}" :src="order.status=='待发货'? 'images/daifahuo.png': 'images/yifahuo.png'" alt="">
    </div>
    <div class="userInfo">
        <h3>收货地址</h3>
        <p><span>{{order.consignee.consigneeName}}</span><span>{{order.consignee.consigneePhone}}</span></p>
        <p>{{order.consignee.consigneeAddress}}</p>
        <!--<div>预计送达时间<span>02月1日 09:00～18:00</span></div>-->
    </div>
    <div class="commodity">
        <h3><img :src="order.shopimage"  alt="">{{order.shopname}}</h3>
        <div class="commodity-Info">
            <img :src="order.commodity[0].commodityimage" alt="">
            <div>
                <p class="commodity-Info-name">{{order.commodity[0].commodityname}}</p>
                <p class="commodity-Info-spec">{{order.commodity[0].commodityinfo}}</p>
                <p class="commodity-Info-price">￥<strong>{{order.commodity[0].commodityprice}}</strong><span>*{{order.commodity[0].commodityNum}}</span></p>
            </div>
        </div>
        <div class="commodity-price">
            <p>订单编号:<span>{{order.tradeId}}</span></p>
            <p>下单时间:<span>{{$formatDate(order.orderTime)}}</span></p>
            <p v-if="logistics">配送方式:<span>{{logistics.company}}</span></p>
            <!--<p>配送日期:<span>2017-10-10</span></p>-->
            <p>买家留言:<span>{{order.payInfo}}</span></p>
        </div>
        <div class="commodity-total">
            <p>商品总额 <span>￥{{order.commodity[0].commodityprice * order.commodity[0].commodityNum}}</span></p>
            <p>运费 <span>￥{{order.commodity[0].freight}}</span></p>
            <!--<p>店铺优惠 <span class="red">-￥5.00</span></p>-->
            <p class="last clearfix"><span>需付款: </span><span> ￥{{}}</span></p>
        </div>
        <div class="commodity-other">
            <div>取消订单</div>
            <div>联系商家</div>
        </div>
    </div>
</section>
</body>
<script src="lib/init.js"></script>
<script src="lib/vue.js"></script>
<script src="lib/my.js"></script>
<script src="lib/vueComponent.js"></script>
<script>
    window.addEventListener('load',function () {
        var baseUrl = localStorage.baseUrl,
            token = localStorage.token;
        var order = new Vue({
            el: '#order',
            data: {
                order: null, //订单详情
                logistics: null //物流详情
            },
            created: function () {
                var tradeId = Vue.prototype.$getSearch().tradeId,
                    self = this;
                console.log(tradeId);
                //获取订单详情
                $my.ajax({
                    url: baseUrl + '/order/oneOrder',
                    data: {
                        token: token,
                        tradeId: tradeId
                    },
                    method: 'get',
                    success: function (data) {
                        var data = JSON.parse(data);
                        console.log(data);
                        self.order = data.data;
                    }
                });
//                 获取物流信息
                $my.ajax({
                    url: baseUrl + '/order/orderLogistics',
                    data: {
                        token: token,
                        tradeId: tradeId
                    },
                    method: 'get',
                    success: function (data) {
                        var data = JSON.parse(data);
                        console.log(data);
                        self.logistics = data.data;
                        console.log(self.logistics);
                    }
                });
            }
        });
    });
</script>
</html>